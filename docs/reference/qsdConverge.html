<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate time to reach quasi-stationary stage distribution from a matrix
population model — qsdConverge • Rage</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate time to reach quasi-stationary stage distribution from a matrix
population model — qsdConverge" />
<meta property="og:description" content="Calculate the time in the projection of a cohort through a matrix population
model at which a defined quasi-stationary stage distribution is reached." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jonesor/Rage/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate time to reach quasi-stationary stage distribution from a matrix
population model</h1>
    <small class="dont-index">Source: <a href='https://github.com/jonesor/Rage/blob/master/R/qsdConverge.R'><code>R/qsdConverge.R</code></a></small>
    <div class="hidden name"><code>qsdConverge.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate the time in the projection of a cohort through a matrix population
model at which a defined quasi-stationary stage distribution is reached.</p>
    </div>

    <pre class="usage"><span class='fu'>qsdConverge</span><span class='op'>(</span><span class='va'>matU</span>, conv <span class='op'>=</span> <span class='fl'>0.05</span>, startLife <span class='op'>=</span> <span class='fl'>1</span>, nSteps <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>matU</th>
      <td><p>The survival component of a matrix population model (i.e. a
square projection matrix reflecting survival-related transitions; e.g.
progression, stasis, and retrogression)</p></td>
    </tr>
    <tr>
      <th>conv</th>
      <td><p>Departure of the projection population vector from convergence to
the stationary stage distribution. E.g. this value should be 0.05 if the
user wants to obtain the time step when the stage distribution is within 5<!-- % -->
of the stationary stable distribution.</p></td>
    </tr>
    <tr>
      <th>startLife</th>
      <td><p>The index of the first stage at which the author considers
the beginning of life. Defaults to 1.</p></td>
    </tr>
    <tr>
      <th>nSteps</th>
      <td><p>Number of time steps over which the population will be
projected. Time steps are in the same units as the matrix population model
(see MatrixPeriodicity column in metadata of COM(P)ADRE). Defaults to 1000,
which in most cases is sufficient to reach the quasi-stationary
distribution.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An integer indicating the first time step at which the
  quasi-stationary stage distribution is reached (or an <code>NA</code> and a
  warning if the quasi-stationary distribution is not reached).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Size or stage-based matrix population models (i.e. Lefkovitch models) and
some age-based matrix population models (i.e. Leslie models with a last class
greater than or equal to final age value) are typically parameterised with a
stasis loop in the largest/most-developed stage (e.g. adult survival). The
assumption of constancy in vital rates for individuals in that last stage
typically results in flat mortality and fertility plateaus. These plateaus
may result in mathematical artefacts when examining age-specific patterns
derived from age-from-stage matrix decompositions (Caswell 2001). The
Quasi-stationary Stage Distribution (QSD) can be used to circumvent this
problem. The QSD is the stage distribution that is reached some time before
the ultimate stable stage distribution (SSD, the normalised right eigenvector
of the transition matrix). With this approach, the user can ask what is the
time step in the projection at which the cohort approximates its stable stage
distribution with a given convergence tolerance level (e.g. 95<!-- %). This metric -->
allows the user to use only age-based information from before this point. See
the online supplementary information of Jones et al. (2014) for further
details.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Caswell, H. (2001) Matrix Population Models: Construction,
  Analysis, and Interpretation. Sinauer Associates; 2nd edition. ISBN:
  978-0878930968</p>
<p>Jones, O.R. et al. (2014) Diversity of ageing across the tree of life.
  Nature, 505(7482), 169–173. https://doi.org/10.1038/nature12789</p>
<p>Salguero-Gómez R. (2018) Implications of clonality for ageing research.
  Evolutionary Ecology, 32, 9-28. https://doi.org/10.1007/s10682-017-9923-2</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Hal Caswell &lt;h.caswell@uva.nl&gt;</p>
<p>Owen Jones &lt;jones@biology.sdu.dk&gt;</p>
<p>Roberto Salguero-Gómez &lt;rob.salguero@zoo.ox.ac.uk&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>matU</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>,   <span class='fl'>0</span>,   <span class='fl'>0</span>,   <span class='fl'>0</span><span class='op'>)</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.2</span>, <span class='fl'>0.1</span>,   <span class='fl'>0</span><span class='op'>)</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>  <span class='fl'>0</span>, <span class='fl'>0.3</span>, <span class='fl'>0.3</span>, <span class='fl'>0.1</span><span class='op'>)</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>  <span class='fl'>0</span>,   <span class='fl'>0</span>, <span class='fl'>0.5</span>, <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>qsdConverge</span><span class='op'>(</span><span class='va'>matU</span>, <span class='fl'>0.05</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 7</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Owen R. Jones/Roberto Salguero-Gomez <r.salguero@sheffield.ac.uk>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


